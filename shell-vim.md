# VIM

## 常用
vi +/pattern file:在第一个出现 pattern 的地方打开文件
k:光标向上移动一行
J:光标向下移动一行
cw:更改单词
dw:向后删除一个单词
d2b: 向前删除两个单词
d/keyword:从当前光标删除到 keyword,不包含 keyword
g/function/s/instance/XXXX/g
CTRL G:显示当前行号



## 打开文件

vi file:打开文件


```
vi -R file:以只读模式打开文件
view filw:以只读模式打开文件
vi +n file: 在第 n行打开文件
vi + file: 在最后一行打开文件
vi +/pattern file:在第一个出现 pattern 的地方打开文件
vi +/“you make” file
vi +/you\ make file
vi file1 file2
:w 保存当前文件
:n 切到下一个文件
:N 切到上一个文件
```



## 普通模式(Normal mode)

### 光标移动命令

- ^F:向下滚动一整屏
- ^B:向上滚动一整屏
- ^D:向下滚动半屏
- ^U:向下滚动半屏
- z ENTER:将光标移动到顶部,并向下滚动屏幕
- z .:将光标移动到中部,并向滚动屏幕
- z -:将光标移动到底部,并向上滚动屏幕
- H:光标移动到当前屏幕首行首个字符
- 4H:光标移动到当前屏幕第四行首个字符
- M:光标移动到当前屏幕中部首个字符
- L:光标移动道当前屏幕尾行首个字符
- 3L:光标移动道当前屏幕倒数第三行行首个字符
- (:移动到当前句子开头
- ):移动到当前句子结尾
- h: 光标向左移动一个字符
- 4h: 光标向左移动四个字符
- j:光标向下移动一行
- 2j:光标向下移动两行
- k:光标向上移动一行
- 2k:光标向上移动两行
- l:光标向右移动一个字符
- 0:光标移动到当前行的开头
- ^::光标移动到当前行的首个非空字符
- $:光标移动到当前行的结尾
- w:光标向右移动一个单词,如果单词后有标点,会停留在标点上
- 2w:光标向右移动两个单词,如果单词后有标点,会停留在标点上
- W:光标向右移动一个单词,无视标点
- 2W:光标向右移动两个单词,无视标点
- b:光标向左移动一个单词,如果单词后有标点,会停留在标点上
- 2b:光标向左移动两个单词,如果单词后有标点,会停留在标点上
- B:光标向左移动一个单词,无视标点
- 2B:光标向左移动两个单词,无视标点
- e:光标向右移动到当前单词结尾,无视标点(不停留在标点符号上)
- E:光标向右移动到当前单词结尾,停留在标点符号上
- G:到达文件结尾
- 1G:到达文件顶端

### 插入命令

- i:在光标当前位置插入
- a:在光标后一位插入
- 25a! ESC:在后面插入 25 个!号
- o:在下一行插入
- O:在上一行插入
- I:在行首插入
- A:在行尾插入

### 其他命令

J:合并行命令
5J:合并 5 行
p:放置命令
r:字符替换
8ra:将后续 8 个字符替换为 a
R:字符覆盖,按下 R 会进入覆盖模式,输入的字符会逐一覆盖当前行直到按下 ESC 为止
x:删除单个字符
2x:删除 2 个字符
X:删除光标前的字符
2X:删除光标前两个字符
u:撤销
/:向下查找
d/keyword:从当前光标删除到 keyword,不包含 keyword
?:向上查找
fx:搜索本行的 x,x 代表任意字符,;重复上一个搜索命令方向相同,,重复上一个搜索命令方向相反
dfx:从当前光标删除到字符x,包含字符 x.
mx:标记当前位置,x 代表任意字符
x: 将光标移动到 x 标记所在行的第一个字符

CTRL G:显示当前行号, line 9 of 35 --25%-- col 1

### 需要文本对象的命令

d:删除命令

```
dw:删除一个单词
d2b: 向前删除两个单词
dd:删除当前行
dG:从当前行删除到文件结尾
```

c:更改文本

```
cw: 从光标到当前单词结尾
c2b: 从光标到往前两个单词
c$: 从光标到本行结尾
c0: 从光标到本行开头
cc: 修改正行内容
```

y:复制命令

yw: 复制光标到当前单词结尾2yy: 复制从y标到第二行的内容y$: 复制从光标到本行结尾


~:交换字符大小写

.:重复上一个命令

ZZ: 直接使用





## 命令模式(Command line mode)

e file: 打开新的文件

s:替换

```
1s/11/22:将第一行的 11 换成 22
50,100s/old/new/:将第五十到一百行之间的每一个 old 换成 new
%s/old/new/g:全文替换
g/pattern/s/old/new/g:将全文包含 pattern 的行中的 old 替换为 new
# 示例:更改文件中的路径:%s:/home/user:/home/bear:g 
# 示例:将第一到第十行的中句号改为分号:1,10s/\./;/g
# 示例:将 help 改为 HELP:%s/[Hh]elp/HELP/g
# 示例:将一个或多个空格改为一个空格:%s/  */ /g
# 示例:将冒号后一个或多个空格改为 2 个空格:%s/:  */:  /g
# 示例:删除每一行开头的空白:%/^  *\(.*\)/\1/:%/^  *//
# 示例:在每一行开头添加>  :%s/^/>  /# 为后续 6 行添加冒号:.,+5s/$/:/
# 示例:把文件变为大写:%s/.*/\U&/
```

d:删除行

```
2d:删除第二行3,18d:删除3 到 18行.,$d:删除当前行到文件结尾的文本%d:删除文件中所有行.,.+20d:删除当前行到 20 行之后的文本# 示例:删除空白行:g/^$/d
```

m:移动行

```
1,5m6:将第一到第五行移动到第六行之后20,.吗$:将第二十行到当前行移动到文件结尾226,$m.-2:将 226 行到文件结尾的行移动到当前行的两行之前
```

co:copy复制,t和 co 是一样的

```
1,5co6: 将第一到第五行复制并粘贴到第六行之后%t$:将所有的行复制到文件结尾
```

w:写入命令

```
1,10w newfile:将第一至第十行写入newfile
340,$ >>newfile:将第三百四十行到文件末尾追加到 newfile
```

r file:读入其他文件

```
r /home/path/file10r /home/path/file:将读入文件放在第十行之后
```

=:显示总行数

:/pattern/=:显示第一次出现 pattern 时的行数

wq: 保存并退出

e!: 消除编辑结果,回到原来的文件,编辑过程中有保存,则无法回到最初

!command: 运行命令

```
:!date 显示时间
:!sh 创建一个 shell:!ls 显示当前文件
```

ab sn Short Name: 定义缩写,当在插入模式输入 sn 时会被扩展为 Short Name

unab sn: 取消 sn 的缩写

ab: 显示所有缩写

map v dwelp: 用字符 v 定义一组命令 dwelp,由于颠倒两个单词的位置

```
map e ea:在单词结尾插入文本map K dwElp:对调两个单词的位置
```



### set 命令

控制 vim 环境的文件是.exrc

set all

set ic:搜索时忽略大小写

set noic

set nu:显示行号

set nonu